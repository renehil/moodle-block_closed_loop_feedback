function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}define ("block_closed_loop_support/script_closed_loop_support",["exports","core/templates","core/notification","core/ajax","core/modal_factory","core/modal_events","core/str"],function(a,b,c,d,e,f,g){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;b=i(b);c=i(c);d=i(d);e=i(e);f=i(f);g=i(g);function h(){if("function"!=typeof WeakMap)return null;var a=new WeakMap;h=function(){return a};return a}function i(a){if(a&&a.__esModule){return a}if(null===a||"object"!==_typeof(a)&&"function"!=typeof a){return{default:a}}var b=h();if(b&&b.has(a)){return b.get(a)}var c={},d=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var e in a){if(Object.prototype.hasOwnProperty.call(a,e)){var f=d?Object.getOwnPropertyDescriptor(a,e):null;if(f&&(f.get||f.set)){Object.defineProperty(c,e,f)}else{c[e]=a[e]}}}c.default=a;if(b){b.set(a,c)}return c}var j,k,l,m,n=function(a,b){d.call([{methodname:"block_closed_loop_support_get_modal_body",args:{courseid:a,moduleid:b},done:function done(a){if(null!==j){j.setBody(a.modalbody);if(a.size){j.setLarge()}else{j.setSmall()}}else{c.exception(new Error("Failed to load modal dialog base"))}},fail:c.exception}])},o=function(){g.get_string("responseTitle","block_closed_loop_support").then(function(a){e.create({type:e.types.CANCEL,title:a,body:"<p class=\"text-center\"><i class=\"fa fa-spinner fa-pulse fa-2x fa-fw\"></i></p>",large:!1,scrollable:!0}).then(function(a){a.setButtonText("cancel","Close");a.show();j=a;a.getRoot().on("click","#id_submit_button",p);a.getRoot().on(f.hidden,function(){a.destroy()});r()})}).catch(function(){c.exception(new Error("Failed to load HeaderTitle"))})},p=function(a){a.preventDefault();var b=document.getElementById("id_explanation_textarea").value;if(0===b.length){document.getElementById("no_empty_explanation_label").style="display: visible"}else{document.getElementById("content_modal_body_elem").style="display: visible";d.call([{methodname:"block_closed_loop_support_write_explanation",args:{courseid:k,cmid:l,counter:m,explanation:b},done:q(),fail:c.exception}])}},q=function(){g.get_string("expThanks","block_closed_loop_support").then(function(a){document.getElementById("explain_heading_label").innerHTML="<b>"+a+"<b>";for(var b=document.getElementById("explanation_modal_body_elem").getElementsByTagName("*"),c=0;c<b.length;c++){b[c].disabled=!0}}).catch(function(){c.exception(new Error("Failed to load HeaderTitle"))})},r=function(){d.call([{methodname:"block_closed_loop_support_write_requests",args:{courseid:k,cmid:l},done:function done(a){m=a;n(k,l)},fail:c.exception}])},s=function(a){var b=a.target.getAttribute("id").replace("loopButton_",""),c=b.split("_");k=c[0];l=c[1];o()},t=function(a,c){b.renderForPromise("block_closed_loop_support/loopButton",c).then(function(c){var d=c.html,e=c.js,f=b.prependNodeContents(a,d,e);if(null!==f){f[0].addEventListener("click",function(a){s(a)})}}).catch()};a.init=function init(a){for(var d=0;d<Object.values(a).length;d++){var b={courseid:Object.values(a)[d].courseid,moduleid:Object.values(a)[d].moduleid,tooltip:Object.values(a)[d].tooltip},c=document.getElementById("module-"+b.moduleid);if(c){t(c,b)}}}});
//# sourceMappingURL=script_closed_loop_support.min.js.map
